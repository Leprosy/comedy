<!doctype html>
<html class="no-js" lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Comedia estúpida, generada por los propios usuarios..." />
  <meta property="og:image" content="http://comedia.l3pro.com/upimg/<?php echo $script->content[0]->img ?>" />
  <title>Comedia Estúpida y Barata</title>
  <link rel="stylesheet" href="css/bootstrap.min.css" />

  <style>
    .caption {
      bottom: 0;
      font-size: 3vw;
      line-height: 1em;
      text-shadow: 5px 5px 5px #000;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="row">
      <div class="col-12">
        <h1>Comedia</h1>
      </div>
      <div class="col-12 col-md-4">
        <h2>list</h2>
      </div>

      <div class="col-12 col-md-8">
        <h2 class="title">-</h2>
        <div class="content position-relative">
          <img class="image w-100" src="" />
          <p class="caption position-absolute text-center text-white px-2 w-100"></p>
        </div>
      </div>
    </div>
  </div>
</body>

<script type="module">
  let data = "";
  let slide = 0;

  const $ = (query) => {
    const list = document.querySelectorAll(query);
    if (list.length == 1) return list[0];
    return list;
  }

  const nextSlide = () => {
    if (slide == data.content.length) {
      slide = 0;
    }

    const slideData = data.content[slide];
    $(".caption").innerHTML = slideData.caption;
    $(".image").src = `img/${slideData.img}`;
    slide++;

    setTimeout(nextSlide, slideData.time);
  }

  try {
    const req = await fetch("data/scripts/kramer");
    data = await req.json();
    $(".title").innerHTML = data.title;
    nextSlide();
    console.log(data);
  } catch (e) {
    console.error(e)
  }

</script>

</html>